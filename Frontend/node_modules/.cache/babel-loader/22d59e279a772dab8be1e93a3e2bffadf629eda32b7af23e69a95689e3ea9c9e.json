{"ast":null,"code":"import axios from \"axios\";\nimport { loginUserFailed, loginUserRequest, loginUserSuccess, logOut, updateUsernameFailed, updateUsernameRequest, updateUsernameSuccess } from \"./reducer\";\nexport const loginUser = (body, dispatch) => {\n  dispatch(loginUserRequest());\n  return axios.post(\"http://localhost:3001/api/v1/user/login\", body).then(res => {\n    if (body.rememberMe) {\n      localStorage.setItem(\"token\", res.data.body.token);\n    } else {\n      sessionStorage.setItem(\"token\", res.data.body.token);\n    }\n    getUser(res.data.body.token, dispatch);\n  }).catch(error => {\n    console.error(\"Erreur lors de la connexion : \", error);\n    alert(\"Un problème a été rencontré lors de la connexion.\");\n    dispatch(loginUserFailed(error.message));\n  });\n};\nexport const registerUser = (body, goToSignIn, clearLoading) => {\n  return axios.post(\"http://localhost:3001/api/v1/user/signup\", body).then(() => {\n    goToSignIn();\n    clearLoading();\n    alert(\"Utilisateur ajouté\");\n  }).catch(() => {\n    clearLoading();\n    alert(\"Un problème a été rencontré\");\n  });\n};\nexport const getUser = (token, dispatch) => {\n  dispatch(loginUserRequest());\n  return axios.post(\"http://localhost:3001/api/v1/user/profile\", null, {\n    headers: {\n      Authorization: \"Bearer \" + token\n    }\n  }).then(res => {\n    const payload = {\n      user: res.data.body,\n      token\n    };\n    dispatch(loginUserSuccess(payload));\n    return res.data.body;\n  }).catch(error => {\n    console.error(\"Erreur lors de la connexion : \", error);\n    alert(\"Un problème a été rencontré lors de la connexion.\");\n    dispatch(loginUserFailed(error.message));\n  });\n};\nexport const logOutUser = dispatch => {\n  localStorage.removeItem(\"token\");\n  sessionStorage.removeItem(\"token\");\n  dispatch(logOut());\n};\nexport const updateUsername = (newUsername, token) => dispatch => {\n  dispatch(updateUsernameRequest());\n  return axios.put(\"http://localhost:3001/api/v1/user/profile\", {\n    userName: newUsername\n  }, {\n    headers: {\n      Authorization: \"Bearer \" + token\n    }\n  }).then(response => {\n    dispatch(updateUsernameSuccess({\n      userName: newUsername\n    }));\n  }).catch(error => {\n    console.error(\"Erreur lors de la mise à jour du nom d'utilisateur : \", error);\n    dispatch(updateUsernameFailed(error.message));\n    alert(\"Un problème à été rencontré lors de la mise à jour du nom d'utilisateur.\");\n  });\n};","map":{"version":3,"names":["axios","loginUserFailed","loginUserRequest","loginUserSuccess","logOut","updateUsernameFailed","updateUsernameRequest","updateUsernameSuccess","loginUser","body","dispatch","post","then","res","rememberMe","localStorage","setItem","data","token","sessionStorage","getUser","catch","error","console","alert","message","registerUser","goToSignIn","clearLoading","headers","Authorization","payload","user","logOutUser","removeItem","updateUsername","newUsername","put","userName","response"],"sources":["C:/Users/User/Desktop/OC Intégrateur Web/Projet 10/argentbank/Frontend/src/redux/action.js"],"sourcesContent":["import axios from \"axios\";\r\nimport {\r\n  loginUserFailed,\r\n  loginUserRequest,\r\n  loginUserSuccess,\r\n  logOut,\r\n  updateUsernameFailed,\r\n  updateUsernameRequest,\r\n  updateUsernameSuccess,\r\n} from \"./reducer\";\r\n\r\nexport const loginUser = (body, dispatch) => {\r\n  dispatch(loginUserRequest());\r\n  return axios\r\n    .post(\"http://localhost:3001/api/v1/user/login\", body)\r\n    .then((res) => {\r\n      if (body.rememberMe) {\r\n        localStorage.setItem(\"token\", res.data.body.token);\r\n      }\r\n      else {\r\n        sessionStorage.setItem(\"token\", res.data.body.token);\r\n      }\r\n      getUser(res.data.body.token, dispatch);\r\n    })\r\n    .catch((error) => {\r\n      console.error(\"Erreur lors de la connexion : \", error);\r\n      alert(\"Un problème a été rencontré lors de la connexion.\");\r\n      dispatch(loginUserFailed(error.message));\r\n    });\r\n};\r\n\r\nexport const registerUser = (body, goToSignIn, clearLoading) => {\r\n  return axios\r\n    .post(\"http://localhost:3001/api/v1/user/signup\", body)\r\n    .then(() => {\r\n      goToSignIn();\r\n      clearLoading();\r\n      alert(\"Utilisateur ajouté\");\r\n    })\r\n    .catch(() => {\r\n      clearLoading();\r\n      alert(\"Un problème a été rencontré\");\r\n    });\r\n};\r\n\r\nexport const getUser = (token, dispatch) => {\r\n  dispatch(loginUserRequest());\r\n  return axios\r\n    .post(\"http://localhost:3001/api/v1/user/profile\", null, {\r\n      headers: { Authorization: \"Bearer \" + token },\r\n    })\r\n    .then((res) => {\r\n      const payload = { user: res.data.body, token };\r\n      dispatch(loginUserSuccess(payload));\r\n      return res.data.body;\r\n    })\r\n    .catch((error) => {\r\n      console.error(\"Erreur lors de la connexion : \", error);\r\n      alert(\"Un problème a été rencontré lors de la connexion.\");\r\n      dispatch(loginUserFailed(error.message));\r\n    });\r\n};\r\n\r\nexport const logOutUser = (dispatch) => {\r\n  localStorage.removeItem(\"token\");\r\n  sessionStorage.removeItem(\"token\");\r\n  dispatch(logOut());\r\n};\r\n\r\nexport const updateUsername = (newUsername, token) => (dispatch) => {\r\n  dispatch(updateUsernameRequest());\r\n\r\n  return axios\r\n    .put(\r\n      \"http://localhost:3001/api/v1/user/profile\",\r\n      { userName: newUsername },\r\n      { headers: { Authorization: \"Bearer \" + token } }\r\n    )\r\n    .then((response) => {\r\n      dispatch(updateUsernameSuccess({ userName: newUsername }));\r\n    })\r\n    .catch((error) => {\r\n      console.error(\r\n        \"Erreur lors de la mise à jour du nom d'utilisateur : \",\r\n        error\r\n      );\r\n      dispatch(updateUsernameFailed(error.message));\r\n      alert(\r\n        \"Un problème à été rencontré lors de la mise à jour du nom d'utilisateur.\"\r\n      );\r\n    });\r\n};\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SACEC,eAAe,EACfC,gBAAgB,EAChBC,gBAAgB,EAChBC,MAAM,EACNC,oBAAoB,EACpBC,qBAAqB,EACrBC,qBAAqB,QAChB,WAAW;AAElB,OAAO,MAAMC,SAAS,GAAGA,CAACC,IAAI,EAAEC,QAAQ,KAAK;EAC3CA,QAAQ,CAACR,gBAAgB,CAAC,CAAC,CAAC;EAC5B,OAAOF,KAAK,CACTW,IAAI,CAAC,yCAAyC,EAAEF,IAAI,CAAC,CACrDG,IAAI,CAAEC,GAAG,IAAK;IACb,IAAIJ,IAAI,CAACK,UAAU,EAAE;MACnBC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,GAAG,CAACI,IAAI,CAACR,IAAI,CAACS,KAAK,CAAC;IACpD,CAAC,MACI;MACHC,cAAc,CAACH,OAAO,CAAC,OAAO,EAAEH,GAAG,CAACI,IAAI,CAACR,IAAI,CAACS,KAAK,CAAC;IACtD;IACAE,OAAO,CAACP,GAAG,CAACI,IAAI,CAACR,IAAI,CAACS,KAAK,EAAER,QAAQ,CAAC;EACxC,CAAC,CAAC,CACDW,KAAK,CAAEC,KAAK,IAAK;IAChBC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACtDE,KAAK,CAAC,mDAAmD,CAAC;IAC1Dd,QAAQ,CAACT,eAAe,CAACqB,KAAK,CAACG,OAAO,CAAC,CAAC;EAC1C,CAAC,CAAC;AACN,CAAC;AAED,OAAO,MAAMC,YAAY,GAAGA,CAACjB,IAAI,EAAEkB,UAAU,EAAEC,YAAY,KAAK;EAC9D,OAAO5B,KAAK,CACTW,IAAI,CAAC,0CAA0C,EAAEF,IAAI,CAAC,CACtDG,IAAI,CAAC,MAAM;IACVe,UAAU,CAAC,CAAC;IACZC,YAAY,CAAC,CAAC;IACdJ,KAAK,CAAC,oBAAoB,CAAC;EAC7B,CAAC,CAAC,CACDH,KAAK,CAAC,MAAM;IACXO,YAAY,CAAC,CAAC;IACdJ,KAAK,CAAC,6BAA6B,CAAC;EACtC,CAAC,CAAC;AACN,CAAC;AAED,OAAO,MAAMJ,OAAO,GAAGA,CAACF,KAAK,EAAER,QAAQ,KAAK;EAC1CA,QAAQ,CAACR,gBAAgB,CAAC,CAAC,CAAC;EAC5B,OAAOF,KAAK,CACTW,IAAI,CAAC,2CAA2C,EAAE,IAAI,EAAE;IACvDkB,OAAO,EAAE;MAAEC,aAAa,EAAE,SAAS,GAAGZ;IAAM;EAC9C,CAAC,CAAC,CACDN,IAAI,CAAEC,GAAG,IAAK;IACb,MAAMkB,OAAO,GAAG;MAAEC,IAAI,EAAEnB,GAAG,CAACI,IAAI,CAACR,IAAI;MAAES;IAAM,CAAC;IAC9CR,QAAQ,CAACP,gBAAgB,CAAC4B,OAAO,CAAC,CAAC;IACnC,OAAOlB,GAAG,CAACI,IAAI,CAACR,IAAI;EACtB,CAAC,CAAC,CACDY,KAAK,CAAEC,KAAK,IAAK;IAChBC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;IACtDE,KAAK,CAAC,mDAAmD,CAAC;IAC1Dd,QAAQ,CAACT,eAAe,CAACqB,KAAK,CAACG,OAAO,CAAC,CAAC;EAC1C,CAAC,CAAC;AACN,CAAC;AAED,OAAO,MAAMQ,UAAU,GAAIvB,QAAQ,IAAK;EACtCK,YAAY,CAACmB,UAAU,CAAC,OAAO,CAAC;EAChCf,cAAc,CAACe,UAAU,CAAC,OAAO,CAAC;EAClCxB,QAAQ,CAACN,MAAM,CAAC,CAAC,CAAC;AACpB,CAAC;AAED,OAAO,MAAM+B,cAAc,GAAGA,CAACC,WAAW,EAAElB,KAAK,KAAMR,QAAQ,IAAK;EAClEA,QAAQ,CAACJ,qBAAqB,CAAC,CAAC,CAAC;EAEjC,OAAON,KAAK,CACTqC,GAAG,CACF,2CAA2C,EAC3C;IAAEC,QAAQ,EAAEF;EAAY,CAAC,EACzB;IAAEP,OAAO,EAAE;MAAEC,aAAa,EAAE,SAAS,GAAGZ;IAAM;EAAE,CAClD,CAAC,CACAN,IAAI,CAAE2B,QAAQ,IAAK;IAClB7B,QAAQ,CAACH,qBAAqB,CAAC;MAAE+B,QAAQ,EAAEF;IAAY,CAAC,CAAC,CAAC;EAC5D,CAAC,CAAC,CACDf,KAAK,CAAEC,KAAK,IAAK;IAChBC,OAAO,CAACD,KAAK,CACX,uDAAuD,EACvDA,KACF,CAAC;IACDZ,QAAQ,CAACL,oBAAoB,CAACiB,KAAK,CAACG,OAAO,CAAC,CAAC;IAC7CD,KAAK,CACH,0EACF,CAAC;EACH,CAAC,CAAC;AACN,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}